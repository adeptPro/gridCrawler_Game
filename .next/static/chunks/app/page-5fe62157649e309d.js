(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2061:function(e,t,o){Promise.resolve().then(o.bind(o,6774))},6774:function(e,t,o){"use strict";o.r(t);var r,n,a,i,l=o(7437),s=o(2265);(r=a||(a={})).BLANK="blank",r.SPEEDER="speeder",r.LAVA="lava",r.MUD="mud";let d="blue",c={easy:{blankRatio:.8},medium:{blankRatio:.55},hell:{blankRatio:.3}},p={blank:{healthChange:0,movesChange:-1,color:"#DDDDDD",name:"Blank"},speeder:{healthChange:-5,movesChange:0,color:"#ADD8E6",name:"Speeder"},lava:{healthChange:-50,movesChange:-10,color:"#FF4500",name:"Lava"},mud:{healthChange:-10,movesChange:-5,color:"#A0522D",name:"Mud"}},m=(e,t)=>Math.floor(Math.random()*(t-e)+e),h=e=>{let t=[],o=["speeder","lava","mud"],r=c[e].blankRatio,n=function(){let e,t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;do switch(m(0,4)){case 0:t=0,e=m(0,25);break;case 1:t=24,e=m(0,25);break;case 2:e=0,t=m(0,25);break;default:e=24,t=m(0,25)}while(e===o&&t===r);return{x:e,z:t}},a=n(),i=n(a.x,a.z);for(let e=0;e<25;e++){t[e]=[];for(let n=0;n<25;n++){let l;l=e===a.x&&n===a.z||e===i.x&&n===i.z?"blank":Math.random()<r?"blank":o[Math.floor(Math.random()*o.length)],t[e][n]={id:"cell-".concat(e,"-").concat(n),type:l,gridX:e,gridZ:n,x:(e-12.5+.5)*1,z:(n-12.5+.5)*1}}}return{grid:t,startCellIndices:a,endCellIndices:i}},u=e=>{let{gridData:t,isFpsView:o,playerStartPos:r,startMarkerPos:n,endMarkerPos:a,gameId:i,currentGridIndices:c,visitedCellTrail:m}=e;return(0,s.useEffect)(()=>{let e=document.getElementById("player-sphere");e&&(e.setAttribute("position",r),e.components&&e.components["kinematic-body"]&&e.setAttribute("kinematic-body","velocity",{x:0,y:0,z:0}))},[r,i]),(0,s.useEffect)(()=>{let e=document.getElementById("fps-camera"),t=document.getElementById("fps-player-footprint");e&&e.sceneEl&&(e.setAttribute("look-controls","enabled",o.toString()),o?document.pointerLockElement!==e.sceneEl.canvas&&e.sceneEl.canvas.requestPointerLock():document.pointerLockElement===e.sceneEl.canvas&&document.exitPointerLock()),t&&t.setAttribute("visible",o.toString());let r=document.getElementById("camera-rig");r&&r.setAttribute("camera-controls","enabled",(!o).toString());let n=document.getElementById("player-sphere");n&&n.setAttribute("data-fps-view-active",o.toString())},[o]),(0,l.jsxs)("a-scene",{embedded:!0,physics:"driver: ammo; debug: false;",renderer:"colorManagement: true; physicallyCorrectLights: true;",children:[(0,l.jsx)("a-assets",{timeout:"10000"}),(0,l.jsx)("a-entity",{id:"camera-rig",position:"0 ".concat(20," ").concat(1.25),rotation:"-85 0 0","camera-controls":"enabled: ".concat((!o).toString(),";"),children:(0,l.jsx)("a-camera",{id:"main-camera",active:!o,"wasd-controls":"enabled: false;","look-controls":"enabled: false;"})}),(0,l.jsxs)("a-sphere",{id:"player-sphere",position:"".concat(r.x," ").concat(r.y," ").concat(r.z),radius:.35,color:d,material:"shader: standard; color: ".concat(d,"; emissive: ").concat(d,"; emissiveIntensity: 0.2; roughness: 0.4; metalness: 0.1"),shadow:"cast: true","kinematic-body":"type: kinematic; radius: ".concat(.2975,"; height: ").concat(.7,"; enableSlopes: false; gravity: 0;"),"arrow-controls":"speed: 2.8;",children:[(0,l.jsx)("a-camera",{id:"fps-camera",active:o,position:"0 ".concat(.175," ").concat(0),rotation:"0 0 0","wasd-controls":"enabled: false;","look-controls":"pointerLockEnabled: true; magicWindowTrackingEnabled: false; enabled: false;"}),(0,l.jsx)("a-cylinder",{id:"fps-player-footprint",radius:.2975,height:"0.01",position:"0 ".concat(-.345," 0"),rotation:"0 0 0",material:"shader: flat; color: ".concat("#0000AA","; opacity: ").concat(.5,";"),visible:"false"})]}),(0,l.jsxs)("a-entity",{id:"ground-direction-arrow",visible:"false",children:[(0,l.jsx)("a-box",{id:"arrow-shaft",color:"cyan",height:"0.02",width:"0.08",depth:"0.4",position:"0 0 -0.15",material:"shader: flat; opacity: 0.7;"}),(0,l.jsx)("a-cone",{id:"arrow-head",color:"cyan","radius-bottom":"0.12","radius-top":"0",height:"0.25",position:"0 0 -0.4",rotation:"-90 0 0",material:"shader: flat; opacity: 0.7;"})]}),(0,l.jsx)("a-box",{id:"border-top","static-body":!0,color:"#333333",height:.875,width:25.4,depth:.2,position:"0 ".concat(.4375," ").concat(-12.6)}),(0,l.jsx)("a-box",{id:"border-bottom","static-body":!0,color:"#333333",height:.875,width:25.4,depth:.2,position:"0 ".concat(.4375," ").concat(12.6)}),(0,l.jsx)("a-box",{id:"border-left","static-body":!0,color:"#333333",height:.875,width:.2,depth:25,position:"".concat(-12.6," ").concat(.4375," 0")}),(0,l.jsx)("a-box",{id:"border-right","static-body":!0,color:"#333333",height:.875,width:.2,depth:25,position:"".concat(12.6," ").concat(.4375," 0")}),(0,l.jsxs)("a-entity",{id:"start-marker",position:"".concat(n.x," 0 ").concat(n.z),children:[(0,l.jsx)("a-cylinder",{color:"#4CAF50",radius:.2,height:3,position:"0 ".concat(1.5," 0"),material:"shader: standard; metalness: 0.2; roughness: 0.7;",shadow:"cast: true"}),(0,l.jsx)("a-text",{value:"START",align:"center",color:"#FFFFFF",width:"4",position:"0 ".concat(2.4000000000000004," 0"),"look-at":"[camera]",side:"double"})]}),(0,l.jsxs)("a-entity",{id:"end-marker",position:"".concat(a.x," 0 ").concat(a.z),children:[(0,l.jsx)("a-cylinder",{color:"#F44336",radius:.2,height:3,position:"0 ".concat(1.5," 0"),material:"shader: standard; metalness: 0.2; roughness: 0.7;",shadow:"cast: true"}),(0,l.jsx)("a-text",{value:"END",align:"center",color:"#FFFFFF",width:"4",position:"0 ".concat(2.4000000000000004," 0"),"look-at":"[camera]",side:"double"})]}),(0,l.jsx)("a-sky",{color:"#C0E4F0"}),(0,l.jsx)("a-light",{type:"ambient",color:"#AAA"}),(0,l.jsx)("a-light",{type:"directional",color:"#FFF",intensity:"0.8",position:"-5 ".concat(16," 5"),"shadow-camera-automatic":"#player-sphere, .grid-cell, #ground-direction-arrow, #start-marker, #end-marker"}),(0,l.jsx)("a-light",{type:"directional",color:"#FFF",intensity:"0.4",position:"5 ".concat(16," -5")}),t.flat().map(e=>{let t=p[e.type].color,o=1,r="".concat(e.gridX,",").concat(e.gridZ),i=e.gridX===Math.round(n.x/1+12.5-.5)&&e.gridZ===Math.round(n.z/1+12.5-.5),s=e.gridX===Math.round(a.x/1+12.5-.5)&&e.gridZ===Math.round(a.z/1+12.5-.5);return e.gridX!==c.x||e.gridZ!==c.z||i||s?!m.has(r)||i||s||(t="#32CD32",o=.6):(t="#FFFF99",o=.7),(0,l.jsx)("a-plane",{class:"grid-cell",position:"".concat(e.x," 0 ").concat(e.z),rotation:"-90 0 0",width:.98,height:.98,material:"shader: standard; color: ".concat(t,"; opacity: ").concat(o,"; roughness: 0.8;"),shadow:"receive: true"},e.id)})]},i)},y=e=>{let{onToggleScreen:t,playerName:o,onPlayerNameChange:r,onLoadGame:n}=e,[a,i]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),p=async()=>{if(!o.trim()){c({text:"Please enter a player name to load.",type:"error"}),setTimeout(()=>c(null),3e3);return}i(!0),c(null);let e=await n(o);e?e.playerName===o?(c({text:"Game for ".concat(o," loaded successfully!"),type:"success"}),setTimeout(()=>{c(null),t()},1500)):(c({text:"Saved data for player '".concat(e.playerName,"' found, but you entered '").concat(o,"'. Starting new game."),type:"error"}),setTimeout(()=>{c(null),t()},4e3)):(c({text:"No saved game found for ".concat(o,". Starting new game."),type:"error"}),setTimeout(()=>{c(null),t()},3e3)),i(!1)};return(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#2c3e50",color:"white",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",textAlign:"center",padding:"20px"},children:[(0,l.jsx)("h1",{style:{fontSize:"clamp(2rem, 5vw, 3.5rem)",marginBottom:"25px"},children:"Grid Runner"}),(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("label",{htmlFor:"playerNameInput",style:{marginRight:"10px",fontSize:"1.1rem"},children:"Player Name:"}),(0,l.jsx)("input",{type:"text",id:"playerNameInput",value:o,onChange:e=>r(e.target.value),style:{padding:"8px",fontSize:"1rem",borderRadius:"5px",border:"1px solid #ccc",color:"#000000"}})]}),(0,l.jsxs)("p",{style:{fontSize:"clamp(1rem, 2.5vw, 1.3rem)",marginBottom:"15px",lineHeight:"1.6"},children:[" ARROW KEYS: Move Player ",(0,l.jsx)("br",{})," WASD: Pan Camera | Z/X: Zoom Camera ",(0,l.jsx)("br",{})," C: Toggle Camera View (Bird's-Eye / FPS) ",(0,l.jsx)("br",{})," Reach the ",(0,l.jsx)("strong",{style:{color:"#F44336"},children:"END"})," marker from the ",(0,l.jsx)("strong",{style:{color:"#4CAF50"},children:"START"})," marker! "]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:[(0,l.jsx)("button",{onClick:t,style:{padding:"15px 35px",fontSize:"clamp(1.1rem, 2.8vw, 1.6rem)",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",boxShadow:"0 5px 15px rgba(0,0,0,0.25)",transition:"background-color 0.3s ease, transform 0.1s ease"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#2980b9",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#3498db",onMouseDown:e=>e.currentTarget.style.transform="scale(0.98)",onMouseUp:e=>e.currentTarget.style.transform="scale(1)",children:" Start New Game "}),(0,l.jsxs)("button",{onClick:p,disabled:a,style:{padding:"15px 35px",fontSize:"clamp(1.1rem, 2.8vw, 1.6rem)",backgroundColor:"#27ae60",color:"white",border:"none",borderRadius:"10px",cursor:a?"not-allowed":"pointer",boxShadow:"0 5px 15px rgba(0,0,0,0.25)",transition:"background-color 0.3s ease",opacity:a?.7:1},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#229954",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#27ae60",children:[" ",a?"Loading...":"Load Game"," "]})]}),d&&(0,l.jsx)("div",{style:{marginTop:"15px",padding:"10px",borderRadius:"5px",backgroundColor:"error"===d.type?"rgba(255,0,0,0.7)":"rgba(0,255,0,0.7)",color:"white"},children:d.text}),(0,l.jsx)("p",{style:{marginTop:"30px",fontSize:"0.9rem",color:"#bdc3c7"},children:" (Or press Spacebar to Start/Exit) "})]})},g=e=>{let{onToggleScreen:t,playerName:o,loadedGameState:r,clearLoadedGameState:n,savedGameStateFromApp:a,onSetSavedGameState:i}=e,[d,c]=(0,s.useState)("medium"),[m,y]=(0,s.useState)(0),[g,x]=(0,s.useState)([]),[w,b]=(0,s.useState)({x:0,y:.35,z:0}),[f,v]=(0,s.useState)({x:0,z:0}),[E,k]=(0,s.useState)({x:0,z:0}),[A,S]=(0,s.useState)({x:0,z:0}),[C,F]=(0,s.useState)({x:0,z:0}),[j,z]=(0,s.useState)({x:0,z:0}),[R,T]=(0,s.useState)(new Set),[D,M]=(0,s.useState)(100),[L,I]=(0,s.useState)(200),[P,V]=(0,s.useState)(60),[B,Z]=(0,s.useState)(!1),[X,G]=(0,s.useState)(!1),[K,N]=(0,s.useState)(!1),[U,H]=(0,s.useState)("Game Started!"),[O,W]=(0,s.useState)(!1),[Y,_]=(0,s.useState)(!1),[q,Q]=(0,s.useState)(!1),[J,$]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(null),[eo,er]=(0,s.useState)({playerGridX:0,playerGridZ:0,fpsCamFwdX:0,fpsCamFwdZ:0,fpsCamYaw:0,arrowUpEffectX:0,arrowUpEffectZ:0,playerVelX:0,playerVelZ:0,playerPosX:0,playerPosZ:0}),en=(0,s.useRef)(null),[ea,ei]=(0,s.useState)({playerName:o,difficulty:d,player:{gridX:0,gridZ:0,worldX:0,worldZ:0,health:100,moves:200},game:{timeLeft:60,isFpsView:!1,currentCellType:null,startCell:{x:0,z:0},endCell:{x:0,z:0},isOver:!1,hasWon:!1,timerGameOver:!1},gridData:[],visitedCellTrail:[]}),el=(0,s.useCallback)((e,t)=>{if(t)x(t.gridData),b({x:t.player.worldX,y:.35,z:t.player.worldZ}),v({x:(t.game.startCell.x-12.5+.5)*1,z:(t.game.startCell.z-12.5+.5)*1}),k({x:(t.game.endCell.x-12.5+.5)*1,z:(t.game.endCell.z-12.5+.5)*1}),S({x:t.player.gridX,z:t.player.gridZ}),F(t.game.startCell),z(t.game.endCell),T(new Set(t.visitedCellTrail||[])),M(t.player.health),I(t.player.moves),V(t.game.timeLeft),c(t.difficulty),W(t.game.isFpsView),H("Game Loaded!");else{let{grid:t,startCellIndices:o,endCellIndices:r}=h(e);x(t),b({x:(o.x-12.5+.5)*1,y:.35,z:(o.z-12.5+.5)*1}),v({x:(o.x-12.5+.5)*1,z:(o.z-12.5+.5)*1}),k({x:(r.x-12.5+.5)*1,z:(r.z-12.5+.5)*1}),S(o),F(o),z(r),T(new Set),M(100),I(200),V(60),W(!1),H("Game Reset! Good luck!"),Q(!0),setTimeout(()=>{Q(!1),setTimeout(()=>{Q(!0),setTimeout(()=>{Q(!1)},75)},75)},75)}Z(!1),G(!1),N(!1),y(e=>e+1);let o=document.getElementById("player-sphere");o&&o.setAttribute("arrow-controls","enabled",!0);let r=document.getElementById("camera-rig");r&&r.setAttribute("camera-controls","enabled",!0)},[]);(0,s.useEffect)(()=>{r?(el(r.difficulty,r),n()):el(d)},[d,el,r,n]),(0,s.useEffect)(()=>{if(B||K||X)return;if(P<=0){H("Time&apos;s Up! YOU LOSE!"),G(!0),Z(!0);let e=document.getElementById("player-sphere");e&&e.setAttribute("arrow-controls","enabled",!1);let t=document.getElementById("camera-rig");t&&t.setAttribute("camera-controls","enabled",!1);let o=document.getElementById("fps-camera");o&&o.setAttribute("look-controls","enabled",!1),document.pointerLockElement&&document.exitPointerLock();return}let e=setInterval(()=>{V(e=>e-1)},1e3);return()=>clearInterval(e)},[P,B,K,X]),(0,s.useEffect)(()=>{if(B||K)return;let e=document.getElementById("player-sphere");if(!e)return;let t=setInterval(()=>{let t=e.getAttribute("position");if(!t)return;let o=Math.round(t.x/1+12.5-.5),r=Math.round(t.z/1+12.5-.5),n=Math.max(0,Math.min(24,o)),a=Math.max(0,Math.min(24,r));if(n!==A.x||a!==A.z){var i,l;if(null===(i=g[A.x])||void 0===i?void 0:i[A.z]){let e="".concat(A.x,",").concat(A.z),t=A.x===C.x&&A.z===C.z,o=A.x===j.x&&A.z===j.z;t||o||T(t=>new Set(t).add(e))}S({x:n,z:a});let t=null===(l=g[n])||void 0===l?void 0:l[a];if(t){if(n===j.x&&a===j.z){N(!0),Z(!0),H("You Win! Congratulations!"),e.setAttribute("arrow-controls","enabled",!1);let t=document.getElementById("camera-rig");t&&t.setAttribute("camera-controls","enabled",!1);let o=document.getElementById("fps-camera");o&&o.setAttribute("look-controls","enabled",!1),document.pointerLockElement&&document.exitPointerLock();return}let o=p[t.type],r=D+o.healthChange,i=L+o.movesChange;M(r),I(i),o.healthChange<0&&(_(!0),setTimeout(()=>{_(!1),setTimeout(()=>{_(!0),setTimeout(()=>{_(!1)},75)},75)},75));let l="Player on ".concat(o.name,": Health ").concat(o.healthChange>=0?"+":"").concat(o.healthChange,", Moves ").concat(o.movesChange>=0?"+":"").concat(o.movesChange,".");if(r<=0||i<=0){X||(l=r<=0?"Game Over: Health depleted!":"Game Over: Ran out of moves!",Z(!0)),e.setAttribute("arrow-controls","enabled",!1);let t=document.getElementById("camera-rig");t&&t.setAttribute("camera-controls","enabled",!1);let o=document.getElementById("fps-camera");o&&o.setAttribute("look-controls","enabled",!1),document.pointerLockElement&&document.exitPointerLock()}B||K||X||H(l)}}},100);return()=>clearInterval(t)},[D,L,g,A,B,K,j,X,C]),(0,s.useEffect)(()=>{let e=e=>{B||K||("KeyC"===e.code&&W(e=>{let t=!e;return H(t?"Switched to FPS View.":"Switched to Bird&apos;s-Eye View."),t}),"KeyQ"===e.code&&$(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[B,K]),(0,s.useEffect)(()=>{let e=document.getElementById("ground-direction-arrow"),t=document.getElementById("player-sphere"),r=document.getElementById("fps-camera"),n=()=>{let a=0,i=0,l=0,s=0;if(t&&t.object3D){let e=t.object3D.position;a=parseFloat(e.x.toFixed(2)),i=parseFloat(e.z.toFixed(2));let o=t.components["kinematic-body"];o&&o.data.velocity&&(l=parseFloat(o.data.velocity.x.toFixed(2)),s=parseFloat(o.data.velocity.z.toFixed(2)))}let c=null;if(g.length>0&&g[A.x]&&g[A.x][A.z]&&(c=g[A.x][A.z].type),ei({playerName:o,difficulty:d,player:{gridX:A.x,gridZ:A.z,worldX:a,worldZ:i,health:D,moves:L},game:{timeLeft:P,isFpsView:O,currentCellType:c,startCell:C,endCell:j,isOver:B,hasWon:K,timerGameOver:X},gridData:g,visitedCellTrail:Array.from(R)}),!e){en.current&&cancelAnimationFrame(en.current);return}if(B||K){e.setAttribute("visible","false"),en.current&&cancelAnimationFrame(en.current);return}e.setAttribute("position",{x:a,y:.02,z:i});let p={playerGridX:A.x,playerGridZ:A.z,playerPosX:a,playerPosZ:i,playerVelX:l,playerVelZ:s};if(window.THREE){let o=new window.THREE.Vector3;if(O&&(null==r?void 0:r.object3D)){let t=new window.THREE.Quaternion;r.object3D.getWorldQuaternion(t);let n=new window.THREE.Euler().setFromQuaternion(t,"YXZ");e.setAttribute("rotation",{x:0,y:window.THREE.MathUtils.radToDeg(n.y),z:0}),r.object3D.getWorldDirection(o),p.fpsCamFwdX=parseFloat(o.x.toFixed(2)),p.fpsCamFwdZ=parseFloat(o.z.toFixed(2)),p.fpsCamYaw=parseFloat(window.THREE.MathUtils.radToDeg(n.y).toFixed(1)),p.arrowUpEffectX=parseFloat((-o.x).toFixed(2)),p.arrowUpEffectZ=parseFloat((-o.z).toFixed(2))}else{let o=0;if(t){let e=t.getAttribute("data-last-birds-eye-move");"up"===e?o=0:"down"===e?o=180:"left"===e?o=90:"right"===e&&(o=-90)}e.setAttribute("rotation",{x:0,y:o,z:0}),p.fpsCamFwdX=0,p.fpsCamFwdZ=-1,p.fpsCamYaw=0,p.arrowUpEffectX=0,p.arrowUpEffectZ=-1}}e.setAttribute("visible","true"),er(e=>({...e,...p})),O&&!(B||K)&&(en.current=requestAnimationFrame(n))};return O&&!(B||K)?en.current=requestAnimationFrame(n):(n(),en.current&&(cancelAnimationFrame(en.current),en.current=null)),()=>{en.current&&(cancelAnimationFrame(en.current),en.current=null)}},[A,O,B,K,g,o,d,D,L,P,j,X,C,R]),(0,s.useEffect)(()=>{let e=e=>{(B||K||X)&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.stopPropagation(),el(d))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[B,K,X,d,el]);let es=async()=>{var e,t;et(null);let r={playerName:o,difficulty:d,player:{gridX:A.x,gridZ:A.z,worldX:eo.playerPosX,worldZ:eo.playerPosZ,health:D,moves:L},game:{timeLeft:P,isFpsView:O,currentCellType:(null===(t=g[A.x])||void 0===t?void 0:null===(e=t[A.z])||void 0===e?void 0:e.type)||null,startCell:C,endCell:j,isOver:B,hasWon:K,timerGameOver:X},gridData:g,visitedCellTrail:Array.from(R)};console.log("Attempting to save game state:",r);try{localStorage.setItem("gameState_".concat(o),JSON.stringify(r)),await new Promise(e=>setTimeout(e,700)),i(r),et({text:"Game Saved Successfully!",type:"success"})}catch(e){console.error("Error saving game:",e),et({text:"Error saving game. Please try again.",type:"error"})}setTimeout(()=>et(null),3e3)};return(0,l.jsxs)("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",backgroundColor:"#1A1A1A"},children:[Y&&(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255, 0, 0, 0.25)",zIndex:2e3,pointerEvents:"none"}}),q&&(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 255, 0, 0.25)",zIndex:2e3,pointerEvents:"none"}}),(0,l.jsxs)("div",{style:{padding:"8px 15px",backgroundColor:"rgba(0,0,0,0.9)",color:"white",position:"fixed",top:0,left:0,right:0,zIndex:1e3,fontFamily:"'Consolas', 'Courier New', monospace",fontSize:"0.9em",display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center",marginBottom:"5px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{style:{marginRight:"10px"},children:[o||"Player",":"]}),(0,l.jsxs)("span",{children:["H: ",(0,l.jsx)("strong",{style:{color:Y?"#FF4136":D<25?"#FF4136":D<50?"#FF851B":"#2ECC40"},children:D})]}),(0,l.jsxs)("span",{style:{marginLeft:"10px"},children:["M: ",(0,l.jsx)("strong",{style:{color:L<25?"#FF4136":L<50?"#FF851B":"#7FDBFF"},children:L})]}),(0,l.jsxs)("span",{style:{marginLeft:"10px"},children:["T: ",(0,l.jsxs)("strong",{style:{color:P<10?"#FF4136":P<30?"#FF851B":"#0074D9"},children:[P,"s"]})]})]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("label",{htmlFor:"difficulty-select",style:{marginRight:"5px",fontSize:"0.9em"},children:"Difficulty:"}),(0,l.jsxs)("select",{id:"difficulty-select",value:d,onChange:e=>{c(e.target.value)},disabled:B||K||X,style:{marginRight:"10px",padding:"3px",fontSize:"0.9em",backgroundColor:"#555",color:"white",border:"1px solid #777",borderRadius:"3px"},children:[" ",(0,l.jsx)("option",{value:"easy",children:"Easy"})," ",(0,l.jsx)("option",{value:"medium",children:"Medium"})," ",(0,l.jsx)("option",{value:"hell",children:"Hell"})," "]}),(0,l.jsxs)("div",{style:{fontSize:"0.65em",marginRight:"10px",border:"1px solid #444",padding:"2px 4px",borderRadius:"3px",minWidth:"250px",textAlign:"left",lineHeight:"1.1"},children:["Dbg: Grid(",eo.playerGridX,",",eo.playerGridZ,") P(",eo.playerPosX,",",eo.playerPosZ,")",(0,l.jsx)("br",{}),"V(",eo.playerVelX,",",eo.playerVelZ,") CF(",eo.fpsCamFwdX,",",eo.fpsCamFwdZ,") CYaw:",eo.fpsCamYaw,"\xb0",(0,l.jsx)("br",{}),"UpDir(",eo.arrowUpEffectX,",",eo.arrowUpEffectZ,")"]}),(0,l.jsx)("button",{onClick:es,disabled:B||K||X,style:{padding:"5px 10px",fontSize:"0.9em",cursor:B||K||X?"not-allowed":"pointer",backgroundColor:"#5cb85c",border:"1px solid #4cae4c",borderRadius:"4px",color:"white",opacity:B||K||X?.6:1,marginRight:"5px"},children:" Save "}),(0,l.jsx)("button",{onClick:()=>{a?(el(a.difficulty,a),et({text:"Game loaded from last save point!",type:"success"})):et({text:"No game saved in this session to load.",type:"error"}),setTimeout(()=>et(null),3e3)},disabled:!a||B||K||X,style:{padding:"5px 10px",fontSize:"0.9em",cursor:!a||B||K||X?"not-allowed":"pointer",backgroundColor:"#f0ad4e",border:"1px solid #eea236",borderRadius:"4px",color:"white",opacity:!a||B||K||X?.6:1,marginRight:"5px"},children:" Load "}),(0,l.jsx)("button",{onClick:t,disabled:B||K||X,style:{padding:"5px 10px",fontSize:"0.9em",cursor:B||K||X?"not-allowed":"pointer",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"white",opacity:B||K||X?.6:1},children:" Exit "})]})]}),(0,l.jsxs)("div",{style:{fontSize:"0.85em",textAlign:"left",width:"100%",marginBottom:"5px"},children:[" Controls: [Arrows: Player] [WASD: Cam Pan] [Z/X: Cam Zoom] [C: Toggle View (",O?"FPS":"Bird&apos;s-Eye",")] [Q: Toggle GameState Debug] "]}),(0,l.jsxs)("div",{style:{fontSize:"0.8em",textAlign:"left",width:"100%",display:"flex",flexWrap:"wrap",alignItems:"center"},children:[" ",(0,l.jsx)("strong",{style:{marginRight:"5px"},children:"Legend: "})," ",Object.entries(p).map(e=>{let[t,{name:o,color:r,healthChange:n,movesChange:a}]=e,i=[];return 0!==n&&i.push("H:".concat(n)),0!==a&&i.push("M:".concat(a)),(0,l.jsxs)("span",{style:{marginRight:"10px",display:"inline-flex",alignItems:"center",whiteSpace:"nowrap"},children:[" ",(0,l.jsx)("span",{style:{width:"10px",height:"10px",backgroundColor:r,marginRight:"4px",border:"1px solid #444",display:"inline-block"}})," ",o," ",i.length>0?"(".concat(i.join(", "),")"):""," "]},t)})," "]})]}),J&&(0,l.jsx)("div",{style:{position:"fixed",top:"120px",left:"10px",backgroundColor:"rgba(40,40,40,0.9)",color:"#E0E0E0",padding:"10px",borderRadius:"5px",zIndex:998,fontSize:"0.6em",fontFamily:"'Consolas', 'Courier New', monospace",maxHeight:"calc(100vh - 220px)",overflowY:"auto",width:"350px",border:"1px solid #666",boxSizing:"border-box",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:(0,l.jsxs)("pre",{style:{margin:0},children:[(0,l.jsx)("strong",{children:"Current GameState:"}),(0,l.jsx)("br",{}),JSON.stringify(ea,null,2)]})}),J&&a&&(0,l.jsx)("div",{style:{position:"fixed",top:"120px",left:"370px",backgroundColor:"rgba(50,50,60,0.9)",color:"#E0E0E0",padding:"10px",borderRadius:"5px",zIndex:998,fontSize:"0.6em",fontFamily:"'Consolas', 'Courier New', monospace",maxHeight:"calc(100vh - 220px)",overflowY:"auto",width:"350px",border:"1px solid #666",boxSizing:"border-box",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:(0,l.jsxs)("pre",{style:{margin:0},children:[(0,l.jsx)("strong",{children:"Saved GameState (Session):"}),(0,l.jsx)("br",{}),JSON.stringify(a,null,2)]})}),ee&&(0,l.jsxs)("div",{style:{position:"fixed",bottom:"40px",left:"50%",transform:"translateX(-50%)",padding:"10px 20px",borderRadius:"5px",backgroundColor:"error"===ee.type?"rgba(220,53,69,0.9)":"rgba(40,167,69,0.9)",color:"white",zIndex:2e3,boxShadow:"0 2px 10px rgba(0,0,0,0.2)"},children:[" ",ee.text," "]}),(0,l.jsxs)("div",{style:{position:"fixed",bottom:"8px",left:"8px",right:"8px",padding:"6px 10px",backgroundColor:"rgba(0,0,0,0.75)",color:"#DDD",textAlign:"center",zIndex:1e3,borderRadius:"4px",fontSize:"0.8em",fontFamily:"'Consolas', 'Courier New', monospace"},children:[" ",U," "]}),B&&!K&&!X&&(0,l.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"25px 35px",backgroundColor:"rgba(30, 30, 30, 0.97)",color:"white",textAlign:"center",zIndex:1001,borderRadius:"12px",border:"1px solid #444",boxShadow:"0 0 25px rgba(0,0,0,0.6)"},children:[" ",(0,l.jsx)("h2",{style:{fontSize:"1.8em",color:"#FF4136",margin:"0 0 12px 0"},children:"Game Over!"})," ",(0,l.jsx)("p",{style:{fontSize:"1em",margin:"0 0 18px 0"},children:U.startsWith("Game Over:")?U.substring(10):"Try again!"})," ",(0,l.jsx)("button",{onClick:()=>el(d),style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#3498db",border:"none",borderRadius:"7px",color:"white",marginRight:"10px"},children:" Try Again "})," ",(0,l.jsx)("button",{onClick:t,style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#555",border:"none",borderRadius:"7px",color:"white"},children:" Menu "})," "]}),X&&(0,l.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"25px 35px",backgroundColor:"rgba(200, 0, 0, 0.97)",color:"white",textAlign:"center",zIndex:1001,borderRadius:"12px",border:"1px solid #8B0000",boxShadow:"0 0 25px rgba(0,0,0,0.6)"},children:[" ",(0,l.jsx)("h2",{style:{fontSize:"2em",color:"#FFFFFF",margin:"0 0 12px 0"},children:"Time's Up!"})," ",(0,l.jsx)("h3",{style:{fontSize:"1.5em",color:"#FFD700",margin:"0 0 18px 0"},children:"YOU LOSE!"})," ",(0,l.jsx)("button",{onClick:()=>el(d),style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#3498db",border:"none",borderRadius:"7px",color:"white",marginRight:"10px"},children:" Try Again "})," ",(0,l.jsx)("button",{onClick:t,style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#555",border:"none",borderRadius:"7px",color:"white"},children:" Menu "})," "]}),K&&(0,l.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"25px 35px",backgroundColor:"rgba(30, 144, 30, 0.97)",color:"white",textAlign:"center",zIndex:1001,borderRadius:"12px",border:"1px solid #2E8B57",boxShadow:"0 0 25px rgba(0,0,0,0.6)"},children:[" ",(0,l.jsx)("h2",{style:{fontSize:"1.8em",color:"#90EE90",margin:"0 0 12px 0"},children:"You Win!"})," ",(0,l.jsx)("p",{style:{fontSize:"1em",margin:"0 0 18px 0"},children:"Congratulations on reaching the end!"})," ",(0,l.jsx)("button",{onClick:()=>el(d),style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#3498db",border:"none",borderRadius:"7px",color:"white",marginRight:"10px"},children:" Play Again "})," ",(0,l.jsx)("button",{onClick:t,style:{padding:"10px 22px",fontSize:"1em",cursor:"pointer",backgroundColor:"#555",border:"none",borderRadius:"7px",color:"white"},children:" Menu "})," "]}),(0,l.jsxs)("div",{style:{marginTop:"0px",height:"100vh"},children:[" ",g.length>0&&(0,l.jsx)(u,{gridData:g,isFpsView:O,playerStartPos:w,startMarkerPos:f,endMarkerPos:E,gameId:m,currentGridIndices:A,visitedCellTrail:R})," "]})]})};(n=i||(i={})).CLICK_TO_PLAY="clickToPlay",n.NOW_PLAYING="nowPlaying",t.default=()=>{let[e,t]=(0,s.useState)("clickToPlay"),[o,r]=(0,s.useState)(!1),[n,a]=(0,s.useState)(""),[i,d]=(0,s.useState)(null),[c,p]=(0,s.useState)(null),m=(0,s.useCallback)(()=>{t(e=>"clickToPlay"===e?"nowPlaying":"clickToPlay")},[]),h=async e=>{console.log("Attempting to load game for player: ".concat(e));try{await new Promise(e=>setTimeout(e,1e3));let t=localStorage.getItem("gameState_".concat(e));if(!t)return console.log("No saved game found for player:",e),null;{let o=JSON.parse(t);if(o.playerName===e)return o.visitedCellTrail=Array.isArray(o.visitedCellTrail)?o.visitedCellTrail:[],console.log("Game loaded successfully:",o),d(o),o;return console.warn("Player name mismatch. Found data for '".concat(o.playerName,"', expected '").concat(e,"'.")),null}}catch(e){return console.error("Error loading game:",e),null}},u=(0,s.useCallback)(t=>{if("Space"===t.code){var o,r,n,a,i,l,s,d,c,p,h;if((null===(o=document.activeElement)||void 0===o?void 0:o.tagName)==="INPUT"||(null===(r=document.activeElement)||void 0===r?void 0:r.tagName)==="TEXTAREA")return;let u=document.getElementById("player-sphere"),y=document.getElementById("camera-rig"),g=document.getElementById("fps-camera"),x=null!==(c=null==u?void 0:null===(a=u.components)||void 0===a?void 0:null===(n=a["arrow-controls"])||void 0===n?void 0:n.data.enabled)&&void 0!==c?c:"nowPlaying"===e,w=null!==(p=null==y?void 0:null===(l=y.components)||void 0===l?void 0:null===(i=l["camera-controls"])||void 0===i?void 0:i.data.enabled)&&void 0!==p?p:"nowPlaying"===e,b=null!==(h=null==g?void 0:null===(d=g.components)||void 0===d?void 0:null===(s=d["look-controls"])||void 0===s?void 0:s.data.enabled)&&void 0!==h&&h;"clickToPlay"===e?(t.preventDefault(),m()):"nowPlaying"!==e||x&&w&&(!b||!document.pointerLockElement)&&(b||document.pointerLockElement)||b&&document.pointerLockElement||(t.preventDefault(),m())}},[m,e]);return(0,s.useEffect)(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[u]),(0,s.useEffect)(()=>{let e=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=document.createElement("script");return n.src=e,n.async=t,o&&(n.onload=o),r&&(n.onerror=r||(()=>console.error("Failed to load script: ".concat(e)))),document.head.appendChild(n),n},t=()=>{if(!window.AFRAME){console.error("AFRAME global not found, cannot register components.");return}window.AFRAME.components["arrow-controls"]||window.AFRAME.registerComponent("arrow-controls",{schema:{speed:{default:2.8},enabled:{default:!0}},init:function(){window.THREE?(this.velocity=new window.THREE.Vector3,this.worldUp=new window.THREE.Vector3(0,1,0),this.forwardVector=new window.THREE.Vector3,this.rightVector=new window.THREE.Vector3):(console.error("THREE.js not available for arrow-controls init"),this.velocity={set:()=>{},add:()=>{},sub:()=>{},normalize:()=>({multiplyScalar:()=>{}}),lengthSq:()=>0},this.worldUp={x:0,y:1,z:0},this.forwardVector={x:0,y:0,z:0,copy:()=>this.forwardVector,applyAxisAngle:()=>this.forwardVector,normalize:()=>this.forwardVector},this.rightVector={x:0,y:0,z:0,copy:()=>this.rightVector,applyAxisAngle:()=>this.rightVector}),this.keys={},this.lastBirdseyeMove="up",this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},remove:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onKeyDown:function(e){this.data.enabled&&(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.code)&&(this.el.sceneEl&&this.el.sceneEl.isPlaying&&this.data.enabled&&e.preventDefault(),"true"!==this.el.getAttribute("data-fps-view-active")&&("ArrowUp"===e.code?this.el.setAttribute("data-last-birds-eye-move","up"):"ArrowDown"===e.code?this.el.setAttribute("data-last-birds-eye-move","down"):"ArrowLeft"===e.code?this.el.setAttribute("data-last-birds-eye-move","left"):"ArrowRight"===e.code&&this.el.setAttribute("data-last-birds-eye-move","right"))),this.keys[e.code]=!0)},onKeyUp:function(e){this.data.enabled&&(this.keys[e.code]=!1)},tick:function(e,t){if(!this.data.enabled||!this.el.sceneEl||!this.el.sceneEl.hasLoaded||!window.THREE||!this.velocity){this.el.components["kinematic-body"]&&this.el.setAttribute("kinematic-body","velocity",{x:0,y:0,z:0});return}let o=t/1e3,r=this.data.speed;if(this.velocity.set(0,0,0),"true"===this.el.getAttribute("data-fps-view-active")){let e=document.getElementById("fps-camera");e&&e.object3D&&(e.object3D.getWorldDirection(this.forwardVector),this.forwardVector.y=0,this.forwardVector.normalize(),this.rightVector.copy(this.forwardVector).applyAxisAngle(this.worldUp,-Math.PI/2),this.keys.ArrowUp&&this.velocity.sub(this.forwardVector),this.keys.ArrowDown&&this.velocity.add(this.forwardVector),this.keys.ArrowLeft&&this.velocity.add(this.rightVector),this.keys.ArrowRight&&this.velocity.sub(this.rightVector))}else this.keys.ArrowUp&&(this.velocity.z-=1),this.keys.ArrowDown&&(this.velocity.z+=1),this.keys.ArrowLeft&&(this.velocity.x-=1),this.keys.ArrowRight&&(this.velocity.x+=1);this.velocity.lengthSq()>0&&this.velocity.normalize().multiplyScalar(r);let n=this.el.getAttribute("position"),a=.85*(this.el.getAttribute("radius")||.35),i=12-a,l=-12+a,s=n.x+this.velocity.x*o,d=n.z+this.velocity.z*o,c=this.velocity.x,p=this.velocity.z;if((this.velocity.x>0&&s>i||this.velocity.x<0&&s<l)&&(c=0),(this.velocity.z>0&&d>i||this.velocity.z<0&&d<l)&&(p=0),this.el.components["kinematic-body"])this.el.setAttribute("kinematic-body","velocity",{x:c,y:0,z:p});else{let e=Math.max(l,Math.min(i,s)),t=Math.max(l,Math.min(i,d));this.el.setAttribute("position",{x:e,y:n.y,z:t})}}}),window.AFRAME.components["camera-controls"]||window.AFRAME.registerComponent("camera-controls",{schema:{panSpeed:{default:5},zoomSpeed:{default:8},minZoom:{default:7.5},maxZoom:{default:37.5},enabled:{default:!0}},init:function(){window.THREE?this.panVector=new window.THREE.Vector3:(console.error("THREE.js not available for camera-controls init"),this.panVector={set:()=>{},normalize:()=>({multiplyScalar:()=>{}}),lengthSq:()=>0,add:()=>{}}),this.keys={},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},remove:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onKeyDown:function(e){this.data.enabled&&(["KeyW","KeyA","KeyS","KeyD","KeyZ","KeyX"].includes(e.code)&&this.el.sceneEl&&this.el.sceneEl.isPlaying&&this.data.enabled&&e.preventDefault(),this.keys[e.code]=!0)},onKeyUp:function(e){this.data.enabled&&(this.keys[e.code]=!1)},tick:function(e,t){if(!this.data.enabled||!this.el.sceneEl||!this.el.sceneEl.hasLoaded||!this.panVector||!window.THREE)return;let o=t/1e3,r=this.data.panSpeed,n=this.data.zoomSpeed,a=this.el.object3D.position;this.panVector.set(0,0,0),this.keys.KeyW&&(this.panVector.z-=1),this.keys.KeyS&&(this.panVector.z+=1),this.keys.KeyA&&(this.panVector.x-=1),this.keys.KeyD&&(this.panVector.x+=1),this.panVector.lengthSq()>0&&(this.panVector.normalize().multiplyScalar(r*o),this.el.object3D.position.add(this.panVector));let i=a.y;this.keys.KeyZ&&(i-=n*o),this.keys.KeyX&&(i+=n*o),i=Math.max(this.data.minZoom,Math.min(this.data.maxZoom,i)),this.el.object3D.position.y=i}}),window.AFRAME.components["arrow-controls"]&&window.AFRAME.components["camera-controls"]&&console.log("Custom A-Frame components registered/verified.")};return window.AFRAME?!window.AFRAME||(window.AFRAME.components["arrow-controls"]&&window.AFRAME.components["camera-controls"]||t(),window.AFRAME.extras&&window.AFRAME.components["event-set"]&&window.AFRAME.components["arrow-controls"]&&window.AFRAME.components["camera-controls"]?o||r(!0):o||setTimeout(()=>{window.AFRAME.components["arrow-controls"]&&window.AFRAME.components["camera-controls"]?o||(r(!0),console.log("Scripts marked ready (fallback).")):console.error("Fallback check: Custom components not registered.")},1e3)):e("https://aframe.io/releases/1.5.0/aframe.min.js",!0,()=>{console.log("A-Frame script loaded."),t(),e("https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js",!0,()=>{console.log("A-Frame Extras loaded."),e("https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js",!0,()=>{console.log("A-Frame Event Set Component loaded."),r(!0)})})}),()=>{window.removeEventListener("keydown",u)}},[u,o]),(0,l.jsxs)("div",{className:"AppContainer",style:{margin:0,padding:0,width:"100vw",height:"100vh",userSelect:"none"},children:[" ","nowPlaying"===e?o?(0,l.jsx)(g,{onToggleScreen:m,playerName:n,loadedGameState:i,clearLoadedGameState:()=>{d(null)},savedGameStateFromApp:c,onSetSavedGameState:e=>{p(e)}}):(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#1A1A1A",color:"white",fontFamily:"'Segoe UI', sans-serif"},children:" Loading Grid Runner Experience... Please Wait. "}):(0,l.jsx)(y,{onToggleScreen:m,playerName:n,onPlayerNameChange:e=>{a(e)},onLoadGame:h})," "]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2061)}),_N_E=e.O()}]);